#!/usr/bin/python3

"""Main script for running state-specific energy landscape code

   Authors: 
       Hugh G. A. Burton  2020-
       Antoine Marie      2021
       Nick Lee           2022-
"""

import sys, argparse, numpy
from datetime import datetime
from xesla.io.config import Config
from xesla.drivers import random_search
from pyscf import gto

def write_splash():
    print("===================================================")
    print("                      XESLA                        ")
    print("===================================================")
    print("  A library for exploring excited-state solutions  ")
    print("  in electronic structure theory.                  ")
    print("                                                   ")
    print("  Written by                                       ")
    print("     Antoine Marie, Nick Lee,                      ")
    print("     and Hugh G. A. Burton                         ")
    print("===================================================")


if __name__=="__main__":
    # Parse in configuration file nuclear geometry
    parser = argparse.ArgumentParser()
    parser.add_argument("input_file", action="store", help="Input file containing calculation configuration")
    parser.add_argument("molecule_file", action="store", help="Text file containing molecular structure")
    args = parser.parse_args()


    # Startup
    write_splash()
    print(datetime.now().strftime("%d %b %Y at %H:%M:%S"))


    # Read the input file
    config = Config(args.input_file)
    config["molecule"]["atom"] = str(args.molecule_file)
    config.print()


    # Setup PySCF molecule
    mol = gto.Mole(**config["molecule"])
    mol.build()


    # Generate wavefunctions 
    wfnlist = None
    if config["jobcontrol"]["guess"] == "fromfile":
        print(config["jobcontrol"]["read_dir"])
    elif config["jobcontrol"]["guess"] == "random":
        wfnlist = random_search(mol, config)
        
